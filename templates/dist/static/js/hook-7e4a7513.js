import{av as ye,n as c,aw as be,p as H,ax as d,ay as k,e as l,r,w as s,R as p,aa as R,aN as G,aB as he,P as me,aO as _e}from"./index-8391854f.js";import{E as V}from"./edit-pen-af58ba35.js";import{d as B}from"./check-3815600c.js";import{c as ge}from"./APIDialplanContext-cbf26d01.js";import{e as Ie}from"./APIAcd-79f5ffee.js";import{b as U}from"./browser-5e8f72a1.js";import{E as Ce}from"./index-46334353.js";import{u as Ee}from"./DialplanExtension-9e3aa3b0.js";const Se=Ee();function J(N){return typeof N=="function"||Object.prototype.toString.call(N)==="[object Object]"&&!_e(N)}ye(Se);const{reqGetAcdNames:je,reqAcdState:W}=Ie;function $e(){const N=c(!0),L=c(!0),g=c([]),z=c({condition:[{field:"regex",regex:[{field:"destination_number"},{}],expression:"any",action:[{application:"bgsystem",data:"adfad",inline:!1}],"anti-action":[{inline:!1}],condition:[{}]},{action:[{inline:!0}]}],continue:!0});let Q=[];const X=[{label:"string",value:"string"},{label:"integer",value:"integer"},{label:"double",value:"double"},{label:"boolean",value:"boolean"},{label:"file",value:"file"},{label:"array",value:"array"},{label:"datetime",value:"datetime"},{label:"date",value:"date"},{label:"time",value:"time"},{label:"wday",value:"wday"}],Y=[{label:"Normal",value:"Normal"},{label:"NoEcho",value:"NoEcho"},{label:"Password",value:"Password"},{label:"PasswordEchoOnEdit",value:"PasswordEchoOnEdit"}],Z=[{label:"boolean",value:"boolean"},{label:"number",value:"number"},{label:"string",value:"string"},{label:"object",value:"object"},{label:"array",value:"array"}];c();const f=c(),o=c();function F(e,t){for(const a of e){if(e&&e.includes(t))return{children:e,display:"属性",editable:!1,name:"parent"};if(a.children&&a.children.includes(t))return a;if(a.children){const n=F(a.children,t);if(n)return n}}return null}const w=(e,t,a)=>{o.value=F(M.value,e),f.value=e};function ee(){const e={name:"",key:Date.now()};Object.keys(f.value).forEach(t=>{e[t]=""}),e.name="new",e.key=Date.now(),o.value.children.push(e);try{d("编辑成功",{type:"success"})}catch{d("编辑失败！",{type:"error"})}}function te(){if(f.value.type!=="object"){k.error("不是objcet不能添加子");return}const e={name:""};Object.keys(f.value).forEach(t=>{typeof e[t]!="object"&&(e[t]="")}),e.name="new",f.value.children||(f.value.children=[]),f.value.children.push(e);try{reqSetDialplanExtensionTemplate(M.value),d("编辑成功",{type:"success"})}catch{d("编辑失败！",{type:"error"})}}function ae(){if(!o.value.children||!f.value)return;const e=o.value.children.indexOf(f.value);e!==-1&&o.value.children.splice(e,1);try{reqSetDialplanExtensionTemplate(M.value),d("编辑成功",{type:"success"})}catch{d("编辑失败！",{type:"error"})}}function le(){if(!o.value||!o.value.children||o.value.children.length<=1){k.warning("子节点不足，无法向上移动");return}const e=o.value.children.indexOf(f.value);if(e<=0){k.warning("当前行已经在顶部，无法再向上移动");return}const t=e-1;[o.value.children[e],o.value.children[t]]=[o.value.children[t],o.value.children[e]];try{reqSetDialplanExtensionTemplate(M.value),d("编辑成功",{type:"success"})}catch{d("编辑失败！",{type:"error"})}}function ne(){if(!o.value||!o.value.children||o.value.children.length<=1){k.warning("子节点不足，无法向下移动");return}const e=o.value.children.indexOf(f.value);if(e>=o.value.children.length-1){k.warning("当前行已经在底部，无法再向下移动");return}const t=e+1;[o.value.children[e],o.value.children[t]]=[o.value.children[t],o.value.children[e]];try{reqSetDialplanExtensionTemplate(M.value),d("编辑成功",{type:"success"})}catch{d("编辑失败！",{type:"error"})}}async function x(e){L.value=!0;const t=await je();if(g.value=t.result,e){const a=g.value.findIndex(u=>u===e||u.includes(e));q(g.value[a]);let n=Number(m.value);m.value=String(++n),U.nextTick(()=>{m.value=String(a)})}else{g.value[0]&&q(g.value[0]);let a=Number(m.value);m.value=String(++a),U.nextTick(()=>{m.value="0"})}U.nextTick(()=>{N.value=!1,L.value=!1})}const I=c({}),D=c({}),y=c(-1),_=c(""),M=c(be(Q,!0)),T=H(()=>(e,t)=>{var a;return(a=I.value[e])==null?void 0:a[t]}),i=H(()=>(e,t)=>{var a,n;return((a=D.value[e])==null?void 0:a.editing)&&t.property===((n=D.value[e])==null?void 0:n.prop)}),v=H(()=>(e,t,a=!1)=>["cursor-pointer","ml-2","transition","delay-100",a?["hover:scale-110","hover:text-red-500"]:i.value(e,t)&&["scale-150","text-red-500"]]);H(()=>(e,t)=>["flex-bc","w-full","h-[32px]",e.hasChildren?["hover:scale-110","hover:text-red-500"]:[""]]);const re=[{label:"编号",prop:"name",hide:function(e,t,a){return!0}},{label:"fueld or application",prop:"field",width:"260",fixed:!0,cellRenderer:({row:e,index:t,column:a})=>l("div",{class:"flex-bc h-[32px] templateItemBox",style:" display:inline-flex; width:100%",onMouseenter:()=>b(e,t,a),onMouseleave:()=>h(t)},[l(r("el-tooltip"),{content:String(e[a.property]),placement:"top"},{default:()=>[s(l("p",{class:"templateItemText"},[e[a.property]]),[[p,!i.value(t,a)]])]}),l(R,{"enter-active-class":"animate__animated animate__fadeInUp animate__faster"},{default:()=>[s(l(r("el-input"),{modelValue:T.value(t,a.property),onInput:n=>E(n,t,a.property)},null),[[p,i.value(t,a)]])]}),s(l(r("iconify-icon-offline"),{icon:B,class:v.value(t,a),onClick:()=>S(t,e,a.property)},null),[[p,i.value(t,a)]]),s(l(r("iconify-icon-offline"),{icon:V,class:`${v.value(t,!0)} templateEditIcon`,onClick:()=>C(e,t,a)},null),[[p,y.value===t&&!i.value(t,a)&&_.value===a.property]])])},{label:"参数名称",prop:"display",cellRenderer:({row:e,index:t,column:a})=>l("div",{class:"flex-bc h-[32px] templateItemBox",style:" display:inline-flex; width:100%",onMouseenter:()=>b(e,t,a),onMouseleave:()=>h(t)},[l(r("el-tooltip"),{content:String(e[a.property]),placement:"top"},{default:()=>[s(l("p",{class:"templateItemText"},[e[a.property]]),[[p,!i.value(t,a)]])]}),l(R,{"enter-active-class":"animate__animated animate__fadeInUp animate__faster"},{default:()=>[s(l(r("el-input"),{modelValue:T.value(t,a.property),onInput:n=>E(n,t,a.property)},null),[[p,i.value(t,a)]])]}),s(l(r("iconify-icon-offline"),{icon:B,class:v.value(t,a),onClick:()=>S(t,e,a.property)},null),[[p,i.value(t,a)]]),s(l(r("iconify-icon-offline"),{icon:V,class:`${v.value(t,!0)} templateEditIcon`,onClick:()=>C(e,t,a)},null),[[p,y.value===t&&!i.value(t,a)&&_.value===a.property]])])},{label:"类型",prop:"type",cellRenderer:({row:e,index:t,column:a})=>{let n;return l(r("el-select"),{modelValue:e[a.property],"onUpdate:modelValue":u=>e[a.property]=u,onChange:u=>$(u,e,t,a)},J(n=Z.map(u=>l(G,{key:u.value,label:u.label,value:u.value},null)))?n:{default:()=>[n]})}},{label:"help",prop:"help",width:"160",cellRenderer:({row:e,index:t,column:a})=>l("div",{class:`flex-bc w-full h-[32px] templateItemBox  ${e.type==="object"?"disable":""}`,style:" display:inline-flex; width:100%",onMouseenter:()=>b(e,t,a),onMouseleave:()=>h(t)},[l(r("el-tooltip"),{content:e[a.property],placement:"top"},{default:()=>[s(l("p",{class:"templateItemText"},[e[a.property]]),[[p,!i.value(t,a)]])]}),l(R,{"enter-active-class":"animate__animated animate__fadeInUp animate__faster"},{default:()=>[s(l(r("el-input"),{modelValue:T.value(t,a.property),onInput:n=>E(n,t,a.property)},null),[[p,i.value(t,a)]])]}),s(l(r("iconify-icon-offline"),{icon:B,class:v.value(t,a),onClick:()=>S(t,e,a.property)},null),[[p,i.value(t,a)]]),s(l(r("iconify-icon-offline"),{icon:V,class:`${v.value(t,!0)} templateEditIcon`,onClick:()=>C(e,t,a)},null),[[p,y.value===t&&!i.value(t,a)&&_.value===a.property]])])},{label:"默认值",prop:"value",cellRenderer:({row:e,index:t,column:a})=>l("div",{class:`flex-bc w-full h-[32px] templateItemBox  ${e.type==="object"?"disable":""}`,style:" display:inline-flex; width:100%",onMouseenter:()=>b(e,t,a),onMouseleave:()=>h(t)},[l(r("el-tooltip"),{content:String(e[a.property]),placement:"top"},{default:()=>[s(l("p",{class:"templateItemText"},[e[a.property]]),[[p,!i.value(t,a)]])]}),l(R,{"enter-active-class":"animate__animated animate__fadeInUp animate__faster"},{default:()=>[s(l(r("el-input"),{modelValue:T.value(t,a.property),onInput:n=>E(n,t,a.property)},null),[[p,i.value(t,a)]])]}),s(l(r("iconify-icon-offline"),{icon:B,class:v.value(t,a),onClick:()=>S(t,e,a.property)},null),[[p,i.value(t,a)]]),s(l(r("iconify-icon-offline"),{icon:V,class:`${v.value(t,!0)} templateEditIcon`,onClick:()=>C(e,t,a)},null),[[p,y.value===t&&!i.value(t,a)&&_.value===a.property]])])},{label:"edit",prop:"input_type",cellRenderer:({row:e,index:t,column:a})=>{let n;return l("div",{class:`flex-bc w-full h-[32px] templateItemBox  ${e.type==="object"?"disable":""}`,style:" display:inline-flex; width:100%",onMouseenter:()=>b(e,t,a),onMouseleave:()=>h(t)},[s(l(r("el-select"),{modelValue:e[a.property],"onUpdate:modelValue":u=>e[a.property]=u,onChange:u=>$(u,e,t,a)},J(n=X.map(u=>l(G,{key:u.value,label:u.label,value:u.value},null)))?n:{default:()=>[n]}),[[p,e.type!=="object"]])])}},{label:"tristate",prop:"input_tristate",cellRenderer:({row:e,index:t,column:a})=>e.type==="object"?l("div",{class:"flex-bc w-full h-[32px] templateItemBox  disable "},null):l("div",{class:`flex-bc w-full h-[32px] templateItemBox  ${e.input_type==="boolean"?"":"disable"}  `,onMouseenter:()=>b(e,t,a),onMouseleave:()=>h(t)},[s(l(r("el-switch"),{modelValue:e[a.property],"onUpdate:modelValue":n=>e[a.property]=n,class:"ml-2",onChange:n=>$(n,e,t,a)},null),[[p,e.input_type==="boolean"]])])},{label:"min",prop:"input_min",cellRenderer:({row:e,index:t,column:a})=>e.type==="object"?l("div",{class:"flex-bc w-full h-[32px] templateItemBox  disable "},null):l("div",{class:`flex-bc w-full h-[32px] templateItemBox  ${e.input_type==="integer"?"":"disable"}  ${e.type==="object"?"disable":""}`,onMouseenter:()=>b(e,t,a),onMouseleave:()=>h(t)},[l(r("el-tooltip"),{content:String(e[a.property]),placement:"top"},{default:()=>[s(l("p",{class:"templateItemText"},[e[a.property]]),[[p,!i.value(t,a)]])]}),l(R,{"enter-active-class":"animate__animated animate__fadeInUp animate__faster"},{default:()=>[s(l(r("el-input"),{modelValue:T.value(t,a.property),onInput:n=>E(n,t,a.property)},null),[[p,i.value(t,a)]])]}),s(l(r("iconify-icon-offline"),{icon:B,class:v.value(t,a),onClick:()=>S(t,e,a.property)},null),[[p,i.value(t,a)]]),s(l(r("iconify-icon-offline"),{icon:V,class:`${v.value(t,!0)} templateEditIcon`,onClick:()=>C(e,t,a)},null),[[p,y.value===t&&!i.value(t,a)&&_.value===a.property]])])},{label:"max",prop:"input_max",cellRenderer:({row:e,index:t,column:a})=>e.type==="object"?l("div",{class:"flex-bc w-full h-[32px] templateItemBox  disable "},null):l("div",{class:`flex-bc w-full h-[32px] templateItemBox  ${e.input_type==="integer"?"":"disable"}`,onMouseenter:()=>b(e,t,a),onMouseleave:()=>h(t)},[l(r("el-tooltip"),{content:String(e[a.property]),placement:"top"},{default:()=>[s(l("p",{class:"templateItemText"},[e[a.property]]),[[p,!i.value(t,a)]])]}),l(R,{"enter-active-class":"animate__animated animate__fadeInUp animate__faster"},{default:()=>[s(l(r("el-input"),{modelValue:T.value(t,a.property),onInput:n=>E(n,t,a.property)},null),[[p,i.value(t,a)]])]}),s(l(r("iconify-icon-offline"),{icon:B,class:v.value(t,a),onClick:()=>S(t,e,a.property)},null),[[p,i.value(t,a)]]),s(l(r("iconify-icon-offline"),{icon:V,class:`${v.value(t,!0)} templateEditIcon`,onClick:()=>C(e,t,a)},null),[[p,y.value===t&&!i.value(t,a)&&_.value===a.property]])])},{label:"echomode",prop:"echomode",cellRenderer:({row:e,index:t,column:a})=>{if(e.type==="object")return l("div",{class:"flex-bc w-full h-[32px] templateItemBox  disable "},null);{let n;return l("div",{class:`flex-bc w-full h-[32px] templateItemBox  ${e.input_type==="integer"||e.input_type==="string"?"":"disable"}`},[s(l(r("el-select"),{modelValue:e[a.property],"onUpdate:modelValue":u=>e[a.property]=u,onChange:u=>$(u,e,t,a)},J(n=Y.map(u=>l(G,{key:u.value,label:u.label,value:u.value},null)))?n:{default:()=>[n]}),[[p,e.input_type==="integer"||e.input_type==="string"]])])}}},{label:"candidate",prop:"input_candidate",width:"160",cellRenderer:({row:e,index:t,column:a})=>e.type==="object"?l("div",{class:"flex-bc w-full h-[32px] templateItemBox  disable "},null):(e.input_candidate||(e.input_candidate=[]),e.input_type!=="array"?l("div",{class:"flex-bc w-full h-[32px] templateItemBox  disable "},null):l(Ce,{data:e.input_candidate,onChange:se,onSubmit:n=>$(n.join(","),e,t,a),key:e.input_candidate},null))},{label:"selectonly",prop:"input_selectonly",cellRenderer:({row:e,index:t,column:a})=>e.type==="object"?l("div",{class:"flex-bc w-full h-[32px] templateItemBox  disable "},null):l("div",{class:`flex-bc w-full h-[32px] templateItemBox  ${e.input_type==="string"||e.input_type==="array"||e.input_candidate.length?"":"disable"}`,onMouseenter:()=>b(e,t,a),onMouseleave:()=>h(t)},[s(l(r("el-switch"),{modelValue:e[a.property],"onUpdate:modelValue":n=>e[a.property]=n,class:"ml-2",onChange:n=>$(n,e,t,a)},null),[[p,e.input_type==="string"||e.input_type==="array"||e.input_candidate.length]])])},{label:"column",prop:"input_column",width:"220",cellRenderer:({row:e,index:t,column:a})=>e.type==="object"?l("div",{class:"flex-bc w-full h-[32px] templateItemBox  disable "},null):l("div",{class:`flex-bc w-full h-[32px] templateItemBox   ${e.input_type==="array"?"":"disable"}`,style:" display:inline-flex; width:100%",onMouseenter:()=>b(e,t,a),onMouseleave:()=>h(t)},[l(r("el-tooltip"),{content:String(e[a.property]),placement:"top"},{default:()=>[s(l("p",{class:"templateItemText"},[e[a.property]]),[[p,!i.value(t,a)]])]}),l(R,{"enter-active-class":"animate__animated animate__fadeInUp animate__faster"},{default:()=>[s(l(r("el-input"),{modelValue:T.value(t,a.property),onInput:n=>E(n,t,a.property)},null),[[p,i.value(t,a)]])]}),s(l(r("iconify-icon-offline"),{icon:B,class:v.value(t,a),onClick:()=>S(t,e,a.property)},null),[[p,i.value(t,a)]]),s(l(r("iconify-icon-offline"),{icon:V,class:`${v.value(t,!0)} templateEditIcon`,onClick:()=>C(e,t,a)},null),[[p,y.value===t&&!i.value(t,a)&&_.value===a.property]])])}];function C(e,t,a){I.value[t]=Object.assign({},I.value[t],{[a.property]:e[a.property]}),D.value[t]=Object.assign({},D.value[t],{editing:!0,prop:a.property})}function b(e,t,a){y.value=t,_.value=a.property}function h(e){var t;_.value="",(t=I.value[e])!=null&&t.value?y.value=e:y.value=-1}function E(e,t,a){I.value[t][a]=e}async function S(e,t,a){t[a]=I.value[e][a];try{await reqSetDialplanExtensionTemplate(M.value),d(`编辑成功,${JSON.stringify(I.value[e][a])}`,{type:"success"})}catch{d("编辑失败！",{type:"error"})}D.value[e]=Object.assign({},D.value[e],{editing:!1,prop:""}),he().then(()=>I.value[e].value=null)}const $=async(e,t,a,n)=>{await C(t,a,n),await E(e,a,n.property),await S(a,t,n.property)},se=e=>{},A=c(!1);let P=null;const q=async e=>{K.value=e;const t=await W(e);z.value,j.value=JSON.stringify(t,null,2),A.value=!1,P&&P(),P=me(j,()=>{A.value=!0,U.nextTick(()=>{})},{deep:!0})},K=c(""),pe=()=>{},ie=async(e,t)=>{const a=await W(e,j.value);k.success(a.message),x(e)},ue=async e=>{const t=e;t.state=!1,j.value=j.value.filter(a=>a!==e),j.value.push(t)},oe=(e,t)=>{j.value.splice(t,1)},j=c([{label:"---已启用---",leave:"on"},{label:"aa"},{label:"bb"},{label:"---未启用---",leave:"off"},{label:"dd"}]),ce=async()=>{const e=await W(O.value.name,[]);k.success(e.message),x(O.value.name),O.value.name=""},ve=async()=>{const e=O.value.name,t=g.value.findIndex(n=>n===e||n.includes(e));q(g.value[t]);let a=Number(m.value);m.value=String(++a),U.nextTick(()=>{m.value=String(t)})},fe=async e=>{const t=await ge(e);k.success(t.message),x()},de=async e=>{},m=c("0"),O=c({name:""});return{namesList:g,ItemNameClickHandle:q,DataListResult:z,testHandle:pe,save:A,setSave:ie,currentName:K,getNames:x,stopWatch:P,treeItemDeleteHandle:ue,onItemAddTopHandle:oe,addNameHandle:ce,form:O,deleteHandle:fe,switchTreeHandle:de,activeCurrent:m,searchNameHandle:ve,treeData:j,columns:re,dataList:M,rowClickHandle:w,currentParent:o,currentRow:f,addRow:ee,addRowChilren:te,deleteRow:ae,moveRowDown:ne,moveRowUp:le,autoExpand:N,loading:L}}export{$e as useColumns};

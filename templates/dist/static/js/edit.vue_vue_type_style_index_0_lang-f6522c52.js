import{a as q,b as J,c as U,d as M}from"./useRowConversionTree-f86c56ba.js";import{V as P}from"./index-7545bf4b.js";import{d as Q,p as W,n,P as F,a0 as G,r as f,o as u,c as m,e as v,j as d,g as o,h as A,z as p,f as x,C as _,i as H,Q as B}from"./index-8391854f.js";const K={class:"dialog-Wrap"},X=o("div",{class:"headerDiv"},null,-1),Y={key:0},Z={key:1,class:"titleName"},ee=o("h2",null," 名称: ",-1),te={class:"treeData"},se={class:"label"},re={key:0,class:"valueDiv"},le={key:0},ae=o("h3",{style:{color:"red"}},"State",-1),oe={class:"treeData"},ie={class:"label"},ne={key:1},ue={class:"dialog-footer"},ve=Q({__name:"edit",props:{selctionRow:Object,visible:Number},emits:["handleCloseVisiable","upData"],setup(O,{emit:N}){const i=O,R=q(),D=W(()=>R.rowStateTree[r.value.itemName]),I=n(!1);let r=n({});const c=n(),V=n();let g=n([]),S=n([]);const j={attributes:!0,attributeFilter:["class"]},E=(t,e)=>{const l=new MutationObserver((w,T)=>{for(let b of w)b.type==="attributes"&&b.attributeName==="class"&&g.value.forEach(C=>{C.className.includes("arrStyle")||C.classList.add("arrStyle")})});return S.value.push(l),l};F(V,()=>{V.value.$el.querySelectorAll(".el-tree-node").forEach(t=>{if(t.querySelector(".array")&&!t.querySelector(".el-tree-node")){g.value.push(t);const e=E();S.value.push(e),S.value.forEach(l=>{l.observe(g.value[g.value.length-1],j)}),t.classList.add("arrStyle")}})});const y=n(!!i.visible),h=t=>{if(y.value=!1,t===void 0)for(let e in r)r[e]="";else t.resetFields(),r.id="";N("handleCloseVisiable")},k=n();G({name:[{required:!0,message:"线路名称不能为空",trigger:"blur"},{min:2,max:20,message:"线路名称为3～20个字符",trigger:"blur"}],caller:[{required:!0,message:"线路名称不能为空",trigger:"blur"}],dialstr:[{required:!0,message:"拨号串不能为空",trigger:"blur"}],rest:[{type:"number",required:!0,trigger:"blur",min:5,max:600,validator:(t,e,l)=>{if(!e)return l(new Error("呼叫间隔不能为空"));if(!Number.isInteger(e))return l(new Error("呼叫间隔为5～600秒之间的整数值"));if(e<5||e>600)return l(new Error("呼叫间隔为5～600秒之间的整数值"));l()}}],count:[{required:!0,message:"呼叫并发不能为空",trigger:"blur"},{type:"number",min:1,max:100,message:"呼叫并发范围为1～100",trigger:"blur"}],timeout:[{required:!0,message:"呼叫超时不能为空",trigger:"blur"},{type:"number",min:40,max:300,message:"呼叫超时范围为40～300",trigger:"blur"}]});const $=async t=>{t&&await t.validate((e,l)=>{if(e)switch(i.visible){case 1:z(),h(t);break;case 2:L(),h(t);break}})},z=()=>{N("upData",c,r.value.itemName)},L=()=>{N("upData",c,r.value.itemName)};return F(()=>i.visible,(t,e)=>{y.value=!!t,t===1?(r.value=JSON.parse(JSON.stringify(i.selctionRow)),c.value=J(r.value),c.value=U(r.value)):t===2&&(r.value.itemName="",c.value=M(q().thisTemplate))}),(t,e)=>{const l=f("el-input"),w=f("el-tree"),T=f("el-form"),b=f("el-button"),C=f("el-drawer");return u(),m("div",K,[v(C,{modelValue:y.value,"onUpdate:modelValue":e[3]||(e[3]=a=>y.value=a),draggable:"",onClose:e[4]||(e[4]=a=>h(k.value)),fullscreen:I.value,size:"50%",title:i.visible===1?"编辑线路":i.visible===2?"新增线路":"查看线路",width:"640px","align-center":"",center:""},{header:d(()=>[X]),footer:d(()=>[o("span",ue,[v(b,{onClick:e[1]||(e[1]=a=>h(k.value))},{default:d(()=>[A("取 消")]),_:1}),v(b,{type:"primary",onClick:e[2]||(e[2]=a=>$(k.value))},{default:d(()=>[A("确 定")]),_:1})])]),default:d(()=>[v(T,{model:c.value,ref_key:"ruleFormRef",ref:k,"label-width":"120px"},{default:d(()=>[i.visible===1?(u(),m("h2",Y,"名称:"+p(x(r).itemName),1)):_("",!0),i.visible===2?(u(),m("div",Z,[ee,v(l,{modelValue:x(r).itemName,"onUpdate:modelValue":e[0]||(e[0]=a=>x(r).itemName=a)},null,8,["modelValue"])])):_("",!0),v(w,{data:c.value,"node-key":"id","default-expand-all":"","expand-on-click-node":!1,id:"treeId",ref_key:"treeId",ref:V},{default:d(({node:a,data:s})=>[o("div",te,[o("span",se,p(a.label),1),s.type!=="object"?(u(),m("div",re,[(u(),H(P,{data:s,key:s.key},null,8,["data"]))])):_("",!0),o("div",{class:B({state:!0,stateColor:String(s.value)!==s.state&&s.value!=s.state})},[o("span",null,p(s.state),1)],2)])]),_:1},8,["data"])]),_:1},8,["model"]),D.value?(u(),m("div",le,[ae,v(w,{data:D.value,"node-key":"id","default-expand-all":"","expand-on-click-node":!1},{default:d(({node:a,data:s})=>[o("div",oe,[o("span",ie,p(a.label),1),s.state?(u(),m("div",{key:0,class:B({state:!0,stateColor:String(s.value)!==s.state&&s.value!=s.state})},p(s.state),3)):_("",!0),s.type!=="object"?(u(),m("span",ne,p(s.value)+" ",1)):_("",!0)])]),_:1},8,["data"])])):_("",!0)]),_:1},8,["modelValue","fullscreen","title"])])}}});export{ve as _};

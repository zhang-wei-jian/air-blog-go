import{d as ae,af as _e,r as Te,o as Se,i as we,j as Y,e as Ce,f as Ee,g as Z}from"./index-8391854f.js";const se=e=>Array.isArray(e),ie=e=>se(e)?e:[e];let Pe=function(e){let t=function(c){return ie(c).forEach(S=>{var v;return b.set(Symbol((v=S.char)==null?void 0:v.innerText),o({...S}))}),this},n=()=>y().filter(c=>c.typeable),a=function(c,S){let v=[...b.keys()];b.set(v[c],o(S))},o=c=>(c.shouldPauseCursor=function(){return!!(this.typeable||this.cursorable||this.deletable)},c),s=function(){b.forEach(c=>delete c.done)},p=function(){b=new Map,t(e)},d=()=>b,y=()=>Array.from(b.values()),m=c=>b.delete(c),E=(c=!1)=>c?y():y().filter(S=>!S.done),T=(c,S=!1)=>S?b.delete(c):b.get(c).done=!0,b=new Map;return t(e),{add:t,set:a,wipe:p,reset:s,destroy:m,done:T,getItems:E,getQueue:d,getTypeable:n}};const oe=e=>Array.from(e),j=e=>document.createTextNode(e);let W=e=>([...e.childNodes].forEach(t=>{if(t.nodeValue){[...t.nodeValue].forEach(n=>{t.parentNode.insertBefore(j(n),t)}),t.remove();return}W(t)}),e);const ue=e=>{let t=document.implementation.createHTMLDocument();return t.body.innerHTML=e,W(t.body)},de="data-typeit-id",A="ti-cursor",Ie="END",Ne={started:!1,completed:!1,frozen:!1,destroyed:!1},x={breakLines:!0,cursor:{autoPause:!0,autoPauseDelay:500,animation:{frames:[0,0,1].map(e=>({opacity:e})),options:{iterations:1/0,easing:"steps(2, start)",fill:"forwards"}}},cursorChar:"|",cursorSpeed:1e3,deleteSpeed:null,html:!0,lifeLike:!0,loop:!1,loopDelay:750,nextStringDelay:750,speed:100,startDelay:250,startDelete:!1,strings:[],waitUntilVisible:!1,beforeString:()=>{},afterString:()=>{},beforeStep:()=>{},afterStep:()=>{},afterComplete:()=>{}},Ae=`[${de}]:before {content: '.'; display: inline-block; width: 0; visibility: hidden;}`;function ce(e,t=!1,n=!1){let a=e.querySelector(`.${A}`),o=document.createTreeWalker(e,NodeFilter.SHOW_ALL,{acceptNode:d=>{var y,m;if(a&&n){if((y=d.classList)!=null&&y.contains(A))return NodeFilter.FILTER_ACCEPT;if(a.contains(d))return NodeFilter.FILTER_REJECT}return(m=d.classList)!=null&&m.contains(A)?NodeFilter.FILTER_REJECT:NodeFilter.FILTER_ACCEPT}}),s,p=[];for(;s=o.nextNode();)s.originalParent||(s.originalParent=s.parentNode),p.push(s);return t?p.reverse():p}function ve(e){return ce(ue(e))}function Le(e,t=!0){return t?ve(e):oe(e).map(j)}const H=e=>document.createElement(e),fe=(e,t="")=>{let n=H("style");n.id=t,n.appendChild(j(e)),document.head.appendChild(n)},ee=e=>(se(e)||(e=[e/2,e/2]),e),te=(e,t)=>Math.abs(Math.random()*(e+t-(e-t))+(e-t));let re=e=>e/2;function De(e){let{speed:t,deleteSpeed:n,lifeLike:a}=e;return n=n!==null?n:t/3,a?[te(t,re(t)),te(n,re(n))]:[t,n]}const xe=e=>(e.forEach(clearTimeout),[]),ke=()=>Math.random().toString().substring(2,9),J=e=>"value"in e;let Me=e=>J(e)?oe(e.value):ce(e,!0).filter(t=>!(t.childNodes.length>0));const Re=(e,t)=>{new IntersectionObserver((a,o)=>{a.forEach(s=>{s.isIntersecting&&(t(),o.unobserve(e))})},{threshold:1}).observe(e)};let D=e=>typeof e=="function"?e():e;const pe=e=>Number.isInteger(e);let X=(e,t=document,n=!1)=>t[`querySelector${n?"All":""}`](e),$e=e=>/body/i.test(e==null?void 0:e.tagName),Fe=(e,t)=>{if(J(e)){e.value=`${e.value}${t.textContent}`;return}t.innerHTML="";let n=$e(t.originalParent)?e:t.originalParent||e;n.insertBefore(t,X("."+A,n)||null)},He=(e,t,n)=>Math.min(Math.max(t+e,0),n.length);const k=(e,t)=>Object.assign({},e,t),Be=(e,t)=>{if(!e)return;let n=e.parentNode;(n.childNodes.length>1||n.isSameNode(t)?e:n).remove()},Qe=(e,t,n)=>{let a=t[n-1],o=X(`.${A}`,e);e=(a==null?void 0:a.parentNode)||e,e.insertBefore(o,a||null)};function qe(e){return typeof e=="string"?X(e):e}const Ue=e=>/<(.+)>(.*?)<\/(.+)>/.test(e.outerHTML);let Ve=(e,t,n)=>new Promise(a=>{let o=async()=>{await e(),a()};n.push(setTimeout(o,t||0))}),ze={"font-family":"","font-weight":"","font-size":"","font-style":"","line-height":"",color:"",transform:"translateX(-.125em)"},je=(e,t)=>{let a=`${`[${de}='${e}']`} .${A}`,o=getComputedStyle(t),s=Object.entries(ze).reduce((p,[d,y])=>`${p} ${d}: var(--ti-cursor-${d}, ${y||o[d]});`,"");fe(`${a} { display: inline-block; width: 0; ${s} }`,e)};const F=(e,t)=>new Array(t).fill(e),ne=({queueItems:e,selector:t,cursorPosition:n,to:a})=>{if(pe(t))return t*-1;let o=new RegExp(Ie,"i").test(a),s=t?[...e].reverse().findIndex(({char:d})=>{let y=d.parentElement,m=y.matches(t);return o&&m?!0:m&&y.firstChild.isSameNode(d)}):-1;s<0&&(s=o?0:e.length-1);let p=o?0:1;return s-n+p};let B=e=>new Promise(t=>{requestAnimationFrame(async()=>{t(await e())})}),me=e=>e==null?void 0:e.getAnimations().find(t=>t.id===e.dataset.tiAnimationId),ye=({cursor:e,frames:t,options:n})=>{let a=e.animate(t,n);return a.pause(),a.id=e.dataset.tiAnimationId,B(()=>{B(()=>{a.play()})}),a},We=({cursor:e,options:t,cursorOptions:n})=>{if(!e||!n)return;let a=me(e),o;a&&(t.delay=a.effect.getComputedTiming().delay,o=a.currentTime,a.cancel());let s=ye({cursor:e,frames:n.animation.frames,options:t});return o&&(s.currentTime=o),s},le=e=>{var t;return(t=e.func)==null?void 0:t.call(null)},Je=async({index:e,queueItems:t,wait:n,cursor:a,cursorOptions:o})=>{let s=t[e][1],p=[],d=e,y=s,m=()=>y&&!y.delay,E=s.shouldPauseCursor()&&o.autoPause;for(;m();)p.push(y),m()&&d++,y=t[d]?t[d][1]:null;if(p.length)return await B(async()=>{for(let c of p)await le(c)}),d-1;let T=me(a),b;return T&&(b={...T.effect.getComputedTiming(),delay:E?o.autoPauseDelay:0}),await n(async()=>{T&&E&&T.cancel(),await B(()=>{le(s)})},s.delay),await We({cursor:a,options:b,cursorOptions:o}),e},Xe=e=>{var t,n;if(typeof e=="object"){let a={},{frames:o,options:s}=x.cursor.animation;return a.animation=e.animation||{},a.animation.frames=((t=e.animation)==null?void 0:t.frames)||o,a.animation.options=k(s,((n=e.animation)==null?void 0:n.options)||{}),a.autoPause=e.autoPause??x.cursor.autoPause,a.autoPauseDelay=e.autoPauseDelay||x.cursor.autoPauseDelay,a}return e===!0?x.cursor:e};const Ge=function(e,t={}){let n=async(r,l,u=!1)=>{w.frozen&&await new Promise(f=>{this.unfreeze=()=>{w.frozen=!1,f()}}),u||await i.beforeStep(this),await Ve(r,l,q),u||await i.afterStep(this)},a=(r,l)=>Je({index:r,queueItems:l,wait:n,cursor:N,cursorOptions:i.cursor}),o=r=>Be(r,h),s=()=>J(h),p=(r=0)=>De(i)[r],d=()=>Me(h),y=(r={})=>{let l=r.delay;l&&g.add({delay:l})},m=(r,l)=>(g.add(r),y(l),this),E=()=>K??L,T=(r={})=>[{func:()=>R(r)},{func:()=>R(i)}],b=r=>{let l=i.nextStringDelay;g.add([{delay:l[0]},...r,{delay:l[1]}])},c=()=>{if(s())return;let r=H("span");return r.className=A,O?(r.innerHTML=ue(i.cursorChar).innerHTML,r):(r.style.visibility="hidden",r)},S=async()=>{if(!s()&&N&&h.appendChild(N),O){je(U,h),N.dataset.tiAnimationId=U;let{animation:r}=i.cursor,{frames:l,options:u}=r;ye({frames:l,cursor:N,options:{duration:i.cursorSpeed,...u}})}},v=()=>{let r=i.strings.filter(l=>!!l);r.forEach((l,u)=>{if(this.type(l),u+1===r.length)return;let f=i.breakLines?[{func:()=>Q(H("BR")),typeable:!0}]:F({func:$,delay:p(1)},g.getTypeable().length);b(f)})},he=async r=>{let l=E();l&&await G({value:l});let u=d().map(f=>[Symbol(),{func:$,delay:p(1),deletable:!0,shouldPauseCursor:()=>!0}]);for(let f=0;f<u.length;f++)await a(f,u);g.reset(),g.set(0,{delay:r})},be=r=>{let l=h.innerHTML;return l?(h.innerHTML="",i.startDelete?(h.innerHTML=l,W(h),b(F({func:$,delay:p(1),deletable:!0},d().length)),r):l.replace(/<!--(.+?)-->/g,"").trim().split(/<br(?:\s*?)(?:\/)?>/).concat(r)):r},M=async(r=!0)=>{w.started=!0;let l=u=>{g.done(u,!r)};try{let u=[...g.getQueue()];for(let _=0;_<u.length;_++){let[P,C]=u[_];if(!C.done){if(!C.deletable||C.deletable&&d().length){let I=await a(_,u);Array(I-_).fill(_+1).map((V,z)=>V+z).forEach(V=>{let[z]=u[V];l(z)}),_=I}l(P)}}if(!r)return this;if(w.completed=!0,await i.afterComplete(this),!i.loop)throw"";let f=i.loopDelay;n(async()=>{await he(f[0]),M()},f[1])}catch{}return this},G=async r=>{L=He(r,L,d()),Qe(h,d(),L)},Q=r=>Fe(h,r),R=async r=>i=k(i,r),ge=async()=>{if(s()){h.value="";return}d().forEach(o)},$=()=>{let r=d();r.length&&(s()?h.value=h.value.slice(0,-1):o(r[L]))};this.break=function(r){return m({func:()=>Q(H("BR")),typeable:!0},r)},this.delete=function(r=null,l={}){r=D(r);let u=T(l),f=r,{instant:_,to:P}=l,C=g.getTypeable(),I=(()=>f===null?C.length:pe(f)?f:ne({queueItems:C,selector:f,cursorPosition:E(),to:P}))();return m([u[0],...F({func:$,delay:_?0:p(1),deletable:!0},I),u[1]],l)},this.empty=function(r={}){return m({func:ge},r)},this.exec=function(r,l={}){let u=T(l);return m([u[0],{func:()=>r(this)},u[1]],l)},this.move=function(r,l={}){r=D(r);let u=T(l),{instant:f,to:_}=l,P=ne({queueItems:g.getTypeable(),selector:r===null?"":r,to:_,cursorPosition:E()}),C=P<0?-1:1;return K=E()+P,m([u[0],...F({func:()=>G(C),delay:f?0:p(),cursorable:!0},Math.abs(P)),u[1]],l)},this.options=function(r,l={}){return r=D(r),R(r),m({},l)},this.pause=function(r,l={}){return m({delay:D(r)},l)},this.type=function(r,l={}){r=D(r);let{instant:u}=l,f=T(l),P=Le(r,i.html).map(I=>({func:()=>Q(I),char:I,delay:u||Ue(I)?0:p(),typeable:I.nodeType===Node.TEXT_NODE})),C=[f[0],{func:async()=>await i.beforeString(r,this)},...P,{func:async()=>await i.afterString(r,this)},f[1]];return m(C,l)},this.is=function(r){return w[r]},this.destroy=function(r=!0){q=xe(q),D(r)&&N&&o(N),w.destroyed=!0},this.freeze=function(){w.frozen=!0},this.unfreeze=()=>{},this.reset=function(r){!this.is("destroyed")&&this.destroy(),r?(g.wipe(),r(this)):g.reset(),L=0;for(let l in w)w[l]=!1;return h[s()?"value":"innerHTML"]="",this},this.go=function(){return w.started?this:(S(),i.waitUntilVisible?(Re(h,M.bind(this)),this):(M(),this))},this.flush=function(r=()=>{}){return S(),M(!1).then(r),this},this.getQueue=()=>g,this.getOptions=()=>i,this.updateOptions=r=>R(r),this.getElement=()=>h;let h=qe(e),q=[],L=0,K=null,w=k({},Ne);t.cursor=Xe(t.cursor??x.cursor);let i=k(x,t);i=k(i,{html:!s()&&i.html,nextStringDelay:ee(i.nextStringDelay),loopDelay:ee(i.loopDelay)});let U=ke(),g=Pe([{delay:i.startDelay}]);h.dataset.typeitId=U,fe(Ae);let O=!!i.cursor&&!s(),N=c();i.strings=be(ie(i.strings)),i.strings.length&&v()},Ke=ae({name:"TypeIt",props:{speed:{type:Number,default:200},values:{type:Array,defalut:[]},className:{type:String,default:"type-it"},cursor:{type:Boolean,default:!0}},render(){return _e("span",{class:this.className},{default:()=>[]})},mounted(){new Ge(`.${this.className}`,{strings:this.values,speed:this.speed,cursor:this.cursor}).go()}}),Oe=Z("div",{class:"card-header"},[Z("span",{class:"font-medium"}," 打字机组件 ")],-1),Ze=ae({name:"Typeit",__name:"index",setup(e){return(t,n)=>{const a=Te("el-card");return Se(),we(a,null,{header:Y(()=>[Oe]),default:Y(()=>[Ce(Ee(Ke),{values:["test1","test2","test3"]})]),_:1})}}});export{Ze as default};
